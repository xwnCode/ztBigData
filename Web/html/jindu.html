<!DOCTYPE html>
<html lang="en">
<head>
    <link href="css/BigData.css" rel="stylesheet" type="text/css" />
    <link href="css/index.css" rel="stylesheet" type="text/css" />
    <link href="css/index01.css" rel="stylesheet" type="text/css" />
    <script src="js/jquery.js" type="text/javascript"></script>
    <link href="js/bstable/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="js/bstable/css/bootstrap-table.css" rel="stylesheet" type="text/css" />
    <link href="css/Security_operation.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="css/ft-carousel.css" />
    <style>
        .example
        {
            width: 824px;
            height: 436px;
            font-size: 40px;
            text-align: center;
            margin: 10px auto;
            background-color: #464576;
        }
        .carousel-item
        {
            line-height: 336px;
            color: #fff;
            font-family: Arial Black;
        }
    </style>
    <meta charset="UTF-8">
     <title>中铁武汉电气化局调度指挥大数据平台-玉磨项目</title>
        <link rel="stylesheet" href="css/reset.css">
</head>
<body>
    <div class="data_bodey">
   <div class="nav" style="font-size: 23px; letter-spacing: 0px">中铁武汉电气化局调度指挥大数据平台-玉磨项目</div>
        <div class="nav_btn">
       
            <div class="btn_left">
                <a href="">
                    <div class="btn_list ">首页</div>
                </a>
                <a href="">
                    <div class="btn_list">调度</div>
                </a>
                <a href="jindu.html">
                    <div class="btn_list listActive">进度</div>
                </a>
                <a href="anquan.html">
                    <div class="btn_list">安全质量</div>
                </a>
                <a href="wuzi.html">
                    <div class="btn_list">物资</div>
                </a>
            </div>
            <div class="btn_right">
                <a href="equipment.html">
                    <div class="btn_list">机械设备</div>
                </a>
                <a href="wanbi.html">
                    <div class="btn_list ">腕臂预配</div>
                </a>
                <a href="diaoxuan.html">
                    <div class="btn_list">接触网吊弦</div>
                </a>
                <a href="chenben.html">
                    <div class="btn_list">成本</div>
                </a>
                <a href="work.html">
                    <div class="btn_list">综合作业</div>
                </a>
            </div>
        </div>
        <div class="index_tabs">
            <div class="inner" style="height: 109%;">
                <div class="left_cage">
                    <div class="dataAllBorder01 cage_cl" style=" height: 34%;
                        position: relative;">
                        <div class="dataAllBorder02">
                            <!--标题栏-->
                            <div class="map_title_box" style="height: 6%">
                                <div class="map_title_innerbox">
                                    <div class="map_title">
                                        各专业已完产值</div>
                                </div>
                            </div>
                            <div class="data_chart" id="buyTime1" style="height: 80%">
                            </div>
                            <div style="color:White;margin-left:10%">
                            总金额：<span id="zje"> </span>万元
                            </div>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl" style="margin-top: 1.5% !important; height: 29.5%;
                        position: relative;">
                        <div class="dataAllBorder02">
                            <!--标题栏-->
                            <div class="map_title_box" style="height: 6%">
                                <div class="map_title_innerbox">
                                    <div class="map_title">
                                        已完产值走势图</div>
                                </div>
                            </div>
                            <div class="data_chart" id="buyTime2">
                            </div>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl" style="margin-top: 1.5% !important; height: 30%;
                        position: relative;">
                        <div class="dataAllBorder02">
                            <!--标题栏-->
                            <div class="map_title_box" style="height: 6%">
                                <div class="map_title_innerbox">
                                    <div class="map_title">
                                        各季度计划产量及已完产量对比图</div>
                                </div>
                            </div>
                            <p class="data_chart" id="bookAret1">
                            </p>
                        </div>
                    </div>
                </div>
                <div class="center_cage">
                    <div class="dataAllBorder02 dataAllBorder01 " style=" height: 35%; position: relative;">
                        <div style="width: 30%; height: 97%; float: left;">
                            <p id="gauge1" style="height: 80%;">
                            </p>
                            <div style="color:White;text-align: center;position: absolute; bottom: 1%;left:8%;">
                            开累完成：<span id="klwc"> </span>万元  <br /> 计划总量：<span id="jhzl"> </span>万元<br /><h4>合同额</h4>
                            </div>
                        </div>
                        <div style="width: 30%; height: 97%; float: left; margin-left: 5%;">
                            <div id="gauge2" style="height: 80%;">
                            </div>
                            <div style="color:White;text-align: center;position: absolute; bottom: 1%;left:42%;">
                            本年完成：<span id="bnwc"> </span>万元 <br />  本年计划：<span id="bnjh"> </span>万元<br /><h4>年度计划产值</h4>
                            </div>
                        </div>
                        <div style="width: 30%; height: 97%; float: left; margin-left: 5%;">
                            <div id="gauge3" style="height: 80%;">
                            </div>
                            <div style="color:White;text-align: center;position: absolute; bottom: 1%;left:78%;">
                            本月完成：<span id="bywc"> </span>万元 <br /> 本月计划：<span id="byjh"> </span>万元<br /><h4>月度计划产值</h4>
                            </div>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl" style="margin-top: 1.5% !important; height: 60.5%;
                        position: relative;">
                        <div class="dataAllBorder02" style="position: relative; overflow: hidden;">
                            <!--标题栏-->
                            <div class="map_title_box" style="height: 5%">
                                <div class="map_title_innerbox">
                                    <div class="map_title">
                                        施工现场进度图</div>
                                </div>
                            </div>
                            <div id="container">
                                <div class="example">
                                    <div class="ft-carousel" id="carousel_3">
                                        <ul class="carousel-inner" id="chooseAreaspi">
<!--                                            <li class="carousel-item"><img src="img/WechatIMG1.jpg" /><div style="background-color: rgba(0, 0, 0, 0.6);
filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);position: absolute; bottom: 35%; width:100%; height:10%;text-align:center "><span style="font-size:20px;">添加文字 </span></div></li>
--><!--                                            <li class="carousel-item"><img src="img/WechatIMG2.jpg"  /><div style="background-color: rgba(0, 0, 0, 0.6);
filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);position: absolute; bottom: 35%;width:100%; height:20%;text-align:center ">工fdaaaaaaaaaaaaaa</div></li>
-->                                            
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="right_cage">
                    <div class="dataAllBorder01 cage_cl" style=" height: 34%;
                        position: relative;">
                        <div class="dataAllBorder02">
                            <!--标题栏-->
                            <div class="map_title_box" style="height: 6%">
                                <div class="map_title_innerbox">
                                    <div class="map_title">
                                        今日施工安排</div>
                                </div>
                            </div>
                            <table id="table1" style="width: 100%">
                            </table>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl check_decrease" style="margin-top: 1.5% !important;
                        height: 61%; position: relative;">
                        <div class="dataAllBorder02">
                            <!--标题栏-->
                            <div class="map_title_box" style="height: 6%">
                                <div class="map_title_innerbox">
                                    <div class="map_title">
                                        实物工程量</div>
                                </div>
                            </div>
                            <table id="table" style="width: 100%">
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/echarts-all.js" type="text/javascript"></script>
    <script src="js/bstable/js/bootstrap-table.js" type="text/javascript"></script>
    <!--<script src="js/jquery.min.js" type="text/javascript"></script>-->
    <script src="js/ft-carousel.min.js" type="text/javascript"></script>
    <script src="datajs/dataByjd.js" type="text/javascript"></script>
    <script type="text/javascript">

        BootstrapTable();
        Get();
        EchartPies();
        EchartBars();
        EchartLines();
        EchartGauges();

        var myChart1;
        var myChart2;
        var myChart3;
        var myChart4; var myChart5; var myChart6;
        window.setInterval(function () {
            Get();
            $('#table1').bootstrapTable('refresh');
            $('#table').bootstrapTable('refresh'); 
//            $('#table1').bootstrapTable('destroy');
//            $('#table').bootstrapTable('destroy');
            //BootstrapTable();
            refreshData1(myChart1, xdata, ydata);
            refreshData2(myChart2, xxdata, yydata);
            refreshData3(myChart3, xxxdata, yyydata, zzzdata);
            refreshData4(myChart4,myChart5,myChart6, htdata, ndjhdata, ydjhata);
        }, 10000);

        function refreshData1(myChart, xdata, ydata) {
            if (!myChart) {
                return;
            }
            //更新数据
            var option = myChart.getOption();

            //myChart.clear();//彻底清空  重新赋值渲染

            if (xdata.length>0) {
                option.legend.data = xdata;
            }
            if (ydata.length > 0) {
                option.series[0].data = ydata;
            }
            
            myChart.setOption(option, true);//不加true 原来的数据还会保留
        }

        function refreshData2(myChart, xxdata, yydata) {
            if (!myChart) {
                return;
            }
            //更新数据
            var option = myChart.getOption();

            if (xxdata.length > 0 && yydata.length > 0) {
                option.series[0].data = xxdata;
                option.series[1].data = yydata;
            }
            
            myChart.setOption(option, true);
        }

        function refreshData3(myChart, xxxdata, yyydata, zzzdata) {
            if (!myChart) {
                return;
            }
            //更新数据
            var option = myChart.getOption();

            if (xxxdata.length > 0 && yyydata.length > 0 && zzzdata.length > 0) {
                option.xAxis[0].data = xxxdata;
                option.series[0].data = yyydata;
                option.series[1].data = zzzdata;
            }
            

            myChart.setOption(option, true);
        }

        function refreshData4(myChart4, myChart5, myChart6, htdata, ndjhdata, ydjhata) {
            //更新数据

            if (!isNaN(htdata)) {
                var option4 = myChart4.getOption();
                option4.series[0].data[0].value = htdata;
                myChart4.setOption(option4, true);
            }

            if (!isNaN(ndjhdata)) {
                var option5 = myChart5.getOption();
                option5.series[0].data[0].value = ndjhdata;
                myChart5.setOption(option5, true);
            }

            if (!isNaN(ydjhata)) {
                var option6 = myChart6.getOption();
                option6.series[0].data[0].value = ydjhata;
                myChart6.setOption(option6, true);
            }
        }

        function BootstrapTable() {
            $('#table1').bootstrapTable({
                method: "post",
                striped: true,
                singleSelect: false,
                url: "../databyjd/TodayPlanByjd.ashx",
                dataType: "json",
                search: false, //显示搜索框
                contentType: "application/x-www-form-urlencoded",
                queryParams: {
                    oper: 'List'
                },
                columns: [
                {
                    title: '序号',
                    field: 'company',
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        return index + 1;
                    }
                },
                {
                    title: '日期',
                    field: 'date',
                    width: 80,
                    align: 'center',
                    formatter: function (value, row, index) {
                        var timestamp = value;
                        var date = new Date(parseInt(timestamp.replace("/Date(", "").replace(")/", ""), 10));
                        Y = date.getFullYear() + '-';
                        M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
                        D = (date.getDate() < 10 ? '0' + (date.getDate()) : date.getDate()) + ' ';
                        h = (date.getHours() < 10 ? '0' + (date.getHours()) : date.getHours()) + ':';
                        m = (date.getMinutes() < 10 ? '0' + (date.getMinutes()) : date.getMinutes()) + ':';
                        s = (date.getSeconds() < 10 ? '0' + (date.getSeconds()) : date.getSeconds());
                        //var NewDtime = Y + M + D + h + m + s;
                        var NewDtime = Y + M + D;
                        return NewDtime;
                    }
                },
                {
                    title: '分部名称',
                    field: 'deptName',
                    width: 80,
                    align: 'center'
//                    cellStyle: formatTableUnit,
//                    formatter: paramsMatter
                },
                {
                    title: '专业',
                    field: 'profession',
                    align: 'center'
                },
                {
                    title: '工作内容',
                    field: 'workContent',
                    width: 80,
                    align: 'center'
                },
                {
                    title: '施工地点',
                    field: 'workPlace',
                    width: 80,
                    align: 'center'
                },
                {
                    title: '负责人',
                    field: 'principal',
                    width: 80,
                    align: 'center'
                }
            ]
            });


            $('#table').bootstrapTable({
                method: "post",
                striped: true,
                singleSelect: false,
                url: "../databyjd/BigPhyWorkByjd.ashx",
                dataType: "json",
                search: false, //显示搜索框
                contentType: "application/x-www-form-urlencoded",
                queryParams: {
                    oper: 'List'
                },
                columns: [
                {
                    title: '专业',
                    field: 'profession',
                    align: 'center',
                    valign: 'middle'
                },
                {
                    title: '项目名称',
                    field: 'projectName',
                    width: 80,
                    align: 'center'
                },
                {
                    title: '单位',
                    field: 'unit',
                    align: 'center'
                },
                {
                    title: '工程总量',
                    field: 'projectTotal',
                    width: 80,
                    align: 'center'
                },
                {
                    title: '开累完成数量',
                    field: 'cumTotal',
                    width: 80,
                    align: 'center'
                }
            ]
            });
        }

             //表格超出宽度鼠标悬停显示td内容
            function paramsMatter(value, row, index) {
                var span = document.createElement("span");
                span.setAttribute("title", value);
                span.innerHTML = value;
                return span.outerHTML;
            }

            //td宽度以及内容超过宽度隐藏
            function formatTableUnit(value, row, index) {
                return {
                    css: {
                        "white-space": "nowrap",
                        "text-overflow": "ellipsis",
                        "overflow": "hidden",
                        "max-width": "80px"
                    }
                }
            } 


        function EchartPies() {
            //            var myChart = echarts.init($("#buyTime1")[0]);
            myChart1 = echarts.init($("#buyTime1")[0]);
            option = {
                title: {
                    text: '已完产值',
                    //subtext: '计划数量:',
                    //itemGap: 30,
                    x: 'center',
                    y: 'center',
                    textAlign: "center",
                    textStyle: {
                        fontWeight: 'normal',
                        fontSize: 15,
                        color: '#FFB6C1'
                    },
                    subtextStyle: {
                            fontWeight: 'normal',
                            fontSize: 14,
                            color: '#FFFFFF',
                            lineHeight: 60
                        }
                    
                },
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                calculable: false,
                legend: {
                    orient: 'vertical',
                    x: 'left',
                    y: 'center',
                    data: xdata,
                    textStyle: {//图例文字的样式
                        color: '#ccc'
                    }
                },
                series: [
        {
            name: '各专业已完产值',
            type: 'pie',
            radius: [40, 80],
            x: '60%',
            width: '35%',
            funnelAlign: 'left',
            max: 1048,
            itemStyle: {
                normal: {
                    label: {
                        show: true,
                        formatter: '{b} : {d}%'
                    }
                }
            },
            data: ydata
        }
    ]
            };
            myChart1.setOption(option);
        }


        function EchartLines() {
            //            var myChart = echarts.init($("#buyTime2")[0]);
            myChart2 = echarts.init($("#buyTime2")[0]);
            var option = {
                tooltip: {
                    trigger: 'axis'
                },
                grid: {
                    y: 30,
                  y2:25,
                    borderWidth: 0
                },
                legend: {
                    data: ['当月开累已完产值', '每月已完产值'],
                    textStyle: {//图例文字的样式
                        color: '#ccc',
                        fontSize: 16
                    }
                },
                calculable: true,
                xAxis: [
        {
            type: 'category',
            boundaryGap: false,
            splitLine: {
                show: false
            },
            axisLabel: {
                show: true,
                textStyle: {
                    color: '#a4a7ab',
                    align: 'center'
                }
            },
            data: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']
        }
    ],
                yAxis: [
        {
            type: 'value',
            splitLine: {
                show: false
            },
            axisLabel: {
                show: true,
                textStyle: {
                    color: '#a4a7ab',
                    align: 'right'
                }
            }
        }
    ],
                series: [
        {
            name: '当月开累已完产值',
            type: 'line',
            stack: '总量',
            data: xxdata
        },
        {
            name: '每月已完产值',
            type: 'line',
            stack: '总量',
            data: yydata
        }
    ]
            };
            myChart2.setOption(option);
        }

        function EchartBars() {
            //            var myChart = echarts.init($("#bookAret1")[0]);
            myChart3 = echarts.init($("#bookAret1")[0]);
            option = {
                tooltip: {
                    trigger: 'axis'
                },
                grid: {
                  
                    y: 30,
                    x2: 30,
                    y2: 40,
                    borderWidth: 0
                },
                legend: {
                    data: ['计划产值', '已完产值'],
                    textStyle: {
                        color: "#e9ebee"
                    }
                },
                //calculable: false,
                xAxis: [
                {
                    type: 'category',
                    splitLine: {
                        show: false
                    },
                    data: xxxdata,
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#a4a7ab',
                            align: 'center'
                        },
                        axisTick: {
                            show: false
                        }
                    }
                }

            ],
                yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#a4a7ab',
                            align: 'right'
                        }
                    },
                    axisTick: {
                        show: false
                    },
                    splitLine: {
                        show: false,
                        lineStyle: {
                            color: "#57617B"
                        }
                    }
                }
            ],
                series: [
                {
                    name: '计划产值',
                    type: 'bar',
                    data: yyydata
                },
                {
                    name: '已完产值',
                    type: 'bar',
                    data: zzzdata
                }
            ]
            };
            myChart3.setOption(option);
        }


        function EchartGauges() {
//            var myChart1 = echarts.init($("#gauge1")[0]);
//            var myChart2 = echarts.init($("#gauge2")[0]);
//            var myChart3 = echarts.init($("#gauge3")[0]);
             myChart4 = echarts.init($("#gauge1")[0]);
             myChart5 = echarts.init($("#gauge2")[0]);
             myChart6 = echarts.init($("#gauge3")[0]);
            option1 = {
//                tooltip: {
//                    formatter: '{a} <br/>{b} : {c}%'
//                },
                series: [
        {
            type: 'gauge',
            radius: ['90%', '95%'],
            splitNumber: 5,  //设置间隔区域的显示数量
            detail: { formatter: '{value}%' ,show:false },
            data: [
            { value: htdata}
            ]
        }
    ]
    };

    option2 = {
//        tooltip: {
//            formatter: '{a} <br/>{b} : {c}%'
//        },
        series: [
        {
            type: 'gauge',
            radius: ['90%', '95%'],
            splitNumber: 5,  //设置间隔区域的显示数量
            detail: { formatter: '{value}%', show: false },
            data: [
            { value: ndjhdata }
            ]
        }
    ]
    };

    option3 = {
//        tooltip: {
//            formatter: '{a} <br/>{b} : {c}%'
//        },
        series: [
        {
            type: 'gauge',
            radius: ['90%', '95%'],
            splitNumber: 5,  //设置间隔区域的显示数量
            detail: { formatter: '{value}%', show: false },
            data: [
            { value: ydjhata }
            ]
        }
    ]
    };
    myChart4.setOption(option1, true);
    myChart5.setOption(option2, true);
    myChart6.setOption(option3, true);
        }
    </script>
    <script type="text/javascript">
        $("#carousel_3").FtCarousel({
            index: 0,
            auto: true,
            time: 3000,
            indicators: false
            //buttons: true
        });
    </script>
</body>
</html>
