<!DOCTYPE html>
<html lang="en">
<head>
    <link href="css/BigData.css" rel="stylesheet" type="text/css" />
    <link href="css/index.css" rel="stylesheet" type="text/css" />
    <link href="css/index01.css" rel="stylesheet" type="text/css" />
    <script src="js/jquery.js" type="text/javascript"></script>
    <link href="js/bstable/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="js/bstable/css/bootstrap-table.css" rel="stylesheet" type="text/css" />
    <link href="css/Security_operation.css" rel="stylesheet" type="text/css" />
    <meta charset="UTF-8">
        <title>中铁武汉电气化局调度指挥大数据平台-玉磨项目</title>
    <link rel="stylesheet" href="css/reset.css">
</head>
<body>
    <div class="data_bodey">
   <div class="nav" style="font-size: 23px; letter-spacing: 0px">中铁武汉电气化局调度指挥大数据平台-玉磨项目</div>
        <div class="nav_btn">
       
            <div class="btn_left">
                <a href="">
                    <div class="btn_list ">首页</div>
                </a>
                <a href="">
                    <div class="btn_list">调度</div>
                </a>
                <a href="jindu.html">
                    <div class="btn_list">进度</div>
                </a>
                <a href="anquan.html">
                    <div class="btn_list">安全质量</div>
                </a>
                <a href="wuzi.html">
                    <div class="btn_list">物资</div>
                </a>
            </div>
            <div class="btn_right">
                <a href="equipment.html">
                    <div class="btn_list">机械设备</div>
                </a>
                <a href="wanbi.html">
                    <div class="btn_list">腕臂预配</div>
                </a>
                <a href="diaoxuan.html">
                    <div class="btn_list listActive">接触网吊弦</div>
                </a>
                <a href="chenben.html">
                    <div class="btn_list">成本</div>
                </a>
                <a href="work.html">
                    <div class="btn_list">综合作业</div>
                </a>
            </div>
        </div>
        <div class="index_tabs">
            <!--安防运作-->
            <div class="inner" style="height: 109%;">
                <div class="left_cage">
                    <div class="dataAllBorder01 cage_cl" style=" height: 34%;">
                        <div class="dataAllBorder02">
                            <div class="map_title_box">
                                <div class="map_title_innerbox">
                                    <div class="map_title" style="background-image: url(img/second_title.png);">
                                        设备档案</div>
                                </div>
                            </div>
                           <table style=" width:100%">
                                <tr>
                                    <td style="width:15%; text-align:center ">
                                        <img id="Img1" src="img/img4/设备.png" width="50" height="50" />
                                    </td>
                                    <td style="color: Yellow; font-size:11.0pt; width:30%">
                                        <p id="Devicename">
                                        </p>
                                    </td>
                                    <td rowspan="2"  style="width:50%; text-align:center">
                                        <img id="imageqse" width="200" height="200" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:15%; text-align:center ">
                                        <img id="Img2" src="img/img4/人物.png" width="50" height="50" />
                                    </td>
                                    <td style="color:Yellow; font-size:11.0pt">
                                        负责人：<span id="Charger"> </span>
                                        <br />
                                        电 话：<span id="Phone"> </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="color:#ffffff; font-size:11.0pt; height:25%;">
                                    <div style="width:92%; height:40px;background-color:#3972b5;padding:6px; margin:8px auto; border-radius:5px">
                                      地点：<span id="Deviceaddress"> </span>
                                    </div>
                                      
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl" style="margin-top: 1.5% !important; height: 60%;
                        position: relative;">
                        <div class="dataAllBorder02">
                            <div class="map_title_box">
                                <div class="map_title_innerbox">
                                    <div class="map_title" style="background-image: url(img/second_title.png);">
                                        当前生产吊玄信息</div>
                                </div>
                            </div>
                            <div class="message_scroll_box">
                                <div class="message_scroll" style="border: none;">
                                    <div class="danger_depart_box" style="width: 90%; height: 90%;">
                                        <ul class="danger_depart_ul" style="width: 50%; height: 80%; margin-left: 15%; float: left">
                                            <li class="danger_ico" style="background-image: url(img/img4/编号.png);"></li>
                                            <li style="margin-top: 4%; font-size: 15px; color: white; text-align: left;">编号</li>
                                            <li class="data data01" style="font-size: 15px;"><span id="CrossSecNum"></span></li>
                                        </ul>
                                        <ul class="danger_depart_ul" style="width: 50%; height: 80%; margin-left: 65%;">
                                            <li class="danger_ico" style="background-image: url(img/img4/长度.png);"></li>
                                            <li style="font-size: 15px; color: white; text-align: left;">长度</li>
                                            <li class="data data01" style="font-size: 15px;"><span id="CurProLenofdrop"></span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="message_scroll" style="border: none;">
                                    <div class="danger_depart_box" style="width: 90%; height: 90%;">
                                        <ul class="danger_depart_ul" style="width: 50%; height: 60%; margin-left: 15%; float: left">
                                            <li class="danger_ico" style="background-image: url(img/img4/握力器.png);"></li>
                                            <li style="margin-top: 2%; font-size: 15px; color: white; text-align: left;">力矩</li>
                                            <li class="data data01" style="font-size: 15px;"><span id="TorqueValue"></span></li>
                                        </ul>
                                        <ul class="danger_depart_ul" style="width: 50%; height: 80%; margin-top: 4%; margin-left: 65%;">
                                            <li class="danger_ico" style="background-image: url(img/img4/线索.png); background-size: 80% 90%">
                                            </li>
                                            <li style="margin-top: 2%; font-size: 15px; color: white; text-align: left;">铜绞线规格</li>
                                            <li class="data data01" style="font-size: 15px;"><span id="TwistedLineSpecs" style="word-break:normal;display:block;word-wrap:break-word;overflow: hidden;width:100px;"></span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="message_scroll" style="border: none;">
                                    <div class="danger_depart_box" style="width: 90%; height: 90%;">
                                        <ul class="danger_depart_ul" style="width: 50%; height: 60%; margin-left: 15%; float: left">
                                            <li class="danger_ico" style="background-image: url(img/img4/线路.png); background-size: 80% 90%">
                                            </li>
                                            <li style="margin-top: 2%; font-size: 15px; color: white; text-align: left;">压接管规格</li>
                                            <li class="data data01" style="font-size: 15px;"><span id="PresPipeSpecs"></span>
                                            </li>
                                        </ul>
                                        <ul class="danger_depart_ul" style="width: 50%; height: 60%; margin-top: 4%; margin-left: 65%;">
                                            <li class="danger_ico" style="background-image: url(img/img4/线材3.png); background-size: 80% 90%">
                                            </li>
                                            <li style="margin-top: 2%; font-size: 15px; color: white; text-align: left;">心形环规格</li>
                                            <li class="data data01" style="font-size: 15px;"><span id="ThimbleSpecs"></span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="message_scroll" style="border: none;">
                                    <div class="danger_depart_box" style="width: 90%; height: 90%;">
                                        <ul class="danger_depart_ul" style="width: 50%; height: 60%; margin-left: 15%; float: left">
                                            <li class="danger_ico" style="background-image: url(img/img4/线索库.png); background-size: 80% 90%">
                                            </li>
                                            <li style="margin-top: 2%; font-size: 15px; color: white; text-align: left;">铜鼻子规格</li>
                                            <li class="data data01" style="font-size: 15px;"><span id="CopNoseSpecs"></span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="center_cage">
                    <div class="dataAllBorder01 cage_cl" style=" height: 34%;
                        position: relative;">
                        <div class="dataAllBorder02" style="position: relative; overflow: hidden;">
                            <img src="img/WechatIMG1.jpg" style="height: 100%; width: 49.5%;" />
                            <img src="img/WechatIMG2.jpg" style="height: 100%; width: 49.5%; float: right" />
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl" style="margin-top: 0.6% !important; height: 29.5%;">
                        <div class="dataAllBorder02">
                            <div class="map_title_box">
                                <div class="map_title_innerbox">
                                    <div class="map_title" style="background-image: url(img/second_title.png);">
                                        设备运行信息</div>
                                </div>
                            </div>
                            <div style="width: 100%; height: 100%; float: left">
                                <div id="main" style="height: 90%; width: 100%; float: left; margin-left: 10%">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl" style="margin-top: 0.6% !important; height: 29.5%;">
                        <div class="dataAllBorder02" id="map_title_innerbox">
                            <div class="map_title_box">
                                <div class="map_title_innerbox">
                                    <div class="map_title" style="background-image: url(img/second_title.png);">
                                        预警信息</div>
                                </div>
                            </div>
                            <table id="table" style="width: 100%">
                            </table>
                        </div>
                    </div>
                </div>
                <div class="right_cage">
                    <!--顶部切换位置-->
                    <div class="dataAllBorder01 cage_cl" style=" height: 34%">
                        <div class="dataAllBorder02">
                            <div class="map_title_box">
                                <div class="map_title_innerbox">
                                    <div class="map_title" style="background-image: url(img/second_title.png);">
                                        产品合格率趋势图</div>
                                </div>
                            </div>
                            <!--  <div class="analysis">
                                产品合格率趋势图：</div>-->
                            <div class="data_chart" id="buyTime1" style="height: 80%;">
                            </div>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl check_decrease" style="margin-top: 1.5% !important;
                        height: 29.5%; position: relative;">
                        <div class="dataAllBorder02">
                            <div class="map_title_box">
                                <div class="map_title_innerbox">
                                    <div class="map_title" style="background-image: url(img/second_title.png);">
                                        周产量统计图</div>
                                </div>
                            </div>
                            <!--  <div class="analysis">
                                周产量统计图：</div>-->
                            <div class="data_chart" id="bookAret1" style="height: 80%;">
                            </div>
                        </div>
                    </div>
                    <div class="dataAllBorder01 cage_cl check_decrease" style="margin-top: 1.5% !important;
                        height: 29.5%; position: relative;">
                        <div class="dataAllBorder02">
                            <div class="map_title_box">
                                <div class="map_title_innerbox">
                                    <div class="map_title" style="background-image: url(img/second_title.png);">
                                        今日产量统计图</div>
                                </div>
                            </div>
                            <!-- <div class="analysis">
                                今日产量统计图：</div>-->
                            <div class="data_chart" id="container_huan" style="height: 80%;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="js/echarts-all.js" type="text/javascript"></script>
        <script src="js/bstable/js/bootstrap-table.js" type="text/javascript"></script>
        <script src="datajs/dataBydx.js" type="text/javascript" type="text/javascript"></script>
        <script type="text/javascript">
//            setInterval(function () {
//                Get();
//                            BootstrapTable();
//                            EchartLines();
//                            EchartBars();
//                            Echarts();
//                            EchartMains();
//            }, 5000);

            Get();
            BootstrapTable();
            EchartLines();
            EchartBars();
            Echarts();
            EchartMains();

            var myChart1;
            var myChart2;
            var myChart3;
            var myChart4;

            //这里用setTimeout代替ajax请求进行演示
            window.setInterval(function () {
                Get();
                BootstrapTable();
                refreshData1(myChart1, ydata);
                refreshData2(myChart2, yzdata, zzdata);
                refreshData3(myChart3, xyzdata, yyzdata, zzzdata);
                refreshData4(myChart4, xdxdata, ydxdata);
            }, 10000);

            function refreshData1(myChart, data) {
                if (!myChart) {
                    return;
                }
                //更新数据
                var option = myChart.getOption();
                option.series[0].data = data;
                myChart.setOption(option);
            }

            function refreshData2(myChart, yzdata, zzdata) {
                if (!myChart) {
                    return;
                }
                //更新数据
                var option = myChart.getOption();
                option.series[0].data = yzdata;
                option.series[1].data = zzdata;
                myChart.setOption(option);
            }

//            function refreshData3(myChart, xyzdata, yyzdata, zzzdata) {
//                if (!myChart) {
//                    return;
//                }
//                //更新数据
//                var option = myChart.getOption();

//                if (option.series != undefined) {
//                    option.title.text = yyzdata;
//                    option.title.subtext = '计划数量:' + xyzdata;
//                    option.series[0].data = zzzdata;
//                    myChart.setOption(option);
//                } else {
//                    Echarts();
//                }
//            }

            function refreshData3(myChart, xyzdata, yyzdata, zzzdata) {
                if (!myChart) {
                    return;
                }
                //更新数据
                var option = myChart.getOption();

                
                    option.title.text = yyzdata;
                    option.title.subtext = '计划数量:' + xyzdata;
                    option.series[0].data = [
                            { value: yyzdata },
                            { value: xyzdata - yyzdata },
                            { value: xyzdata / 3 }
                        ];
                    if (xyzdata == undefined) {
                        option.title.subtext = "";
                    }
                    myChart.setOption(option);
                
            }

            function refreshData4(myChart, xdxdata, ydxdata) {
                if (!myChart) {
                    return;
                }
                //更新数据
                var option = myChart.getOption();
                option.series[0].data = xdxdata;
                option.series[1].data = ydxdata;
                myChart.setOption(option);
            }

            function BootstrapTable() {
                $('#table').bootstrapTable({
                    method: "get",
                    striped: true,
                    singleSelect: false,
                    url: "../databydx/GetWarnInfBydx.ashx",
                    dataType: "json",
                    search: false, //显示搜索框
                    contentType: "application/x-www-form-urlencoded",
                    //queryParams: null,
                    columns: [
                {
                    title: '预警灯',
                    field: 'WarnType',
                    width: 80,
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        if (row['WarnType'] === "急停") {
                            return '<img src="img/img4/灯1.png" style="vertical-align:middle"/>';
                        }
                        if (row['WarnType'] === "停机") {
                            return '<img src="img/img4/灯2.png" />';
                        } if (row['WarnType'] === "警告") {
                            return '<img src="img/img4/灯3.png" />';
                        }
                    }
                },
              {
                  title: '序号',
                  field: 'Id',
                  align: 'center',
                  valign: 'middle',
                  formatter: function (value, row, index) {
                      return index + 1;
                  }
              },

                {
                    title: '设备名称',
                    field: 'DeviceName',
                    align: 'center'
                },

                {
                    title: '模块名称',
                    field: 'ModuleName',
                    align: 'center'
                },
                {
                    title: '预警级别',
                    field: 'WarnLevel',
                    align: 'center'
                },
                 {
                     title: '问题描述',
                     field: 'WarnContent',
                     align: 'center'
                 },
                  {
                      title: '预警时间',
                      field: 'WarnTime',
                      align: 'center',
                      formatter: function (value, row, index) {
                          var timestamp = value;
                          var date = new Date(parseInt(timestamp.replace("/Date(", "").replace(")/", ""), 10));
                          Y = date.getFullYear() + '-';
                          M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
                          D = (date.getDate() < 10 ? '0' + (date.getDate()) : date.getDate()) + ' ';
                          h = (date.getHours() < 10 ? '0' + (date.getHours()) : date.getHours()) + ':';
                          m = (date.getMinutes() < 10 ? '0' + (date.getMinutes()) : date.getMinutes()) + ':';
                          s = (date.getSeconds() < 10 ? '0' + (date.getSeconds()) : date.getSeconds());
                          //var NewDtime = Y + M + D + h + m + s;
                          var NewDtime = Y + M + D;
                          return NewDtime;
                      }
                  }
            ]
                });
            }

            //var myChart = echarts.init($("#buyTime1")[0]);
            function EchartLines() {
                myChart1 = echarts.init($("#buyTime1")[0]);
                var option = {
                    tooltip: {   //提示框，鼠标悬浮交互时的信息提示
                        show: true,
                        trigger: 'axis'
                    },
                    grid: {
                        x: 46,
                        y: 30,
                        x2: 30,
                        y2: 40,
                        borderWidth: 0
                    },
                    calculable: false,
                    xAxis: [
                {
                    type: 'category',
                    //boundaryGap: false,// 不留白，从原点开始
                    //data: xdata,
                    data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                    splitLine: {
                        show: false
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#a4a7ab',
                            align: 'center'
                        }
                    }
                }

            ],
                    yAxis: [
                {
                    name: '%',
                    type: 'value',
                    splitLine: {
                        show: false
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#a4a7ab',
                            align: 'right'
                        }
                    }
                }
            ],
                    series: [
                {
                    type: 'line',
                    data: ydata,
                    itemStyle: {
                        normal: {
                            label: { show: true },
                            lineStyle: {
                                color: '#02bcbc' //改变折线颜色
                            },
                            color: 'White'
                        }
                    },
                    smooth: true//平滑
                }
            ]
                };
                myChart1.setOption(option);
            }

            //var myChart = echarts.init($("#bookAret1")[0]);
            function EchartBars() {
                myChart2 = echarts.init($("#bookAret1")[0]);
                option = {
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {
                        x: 46,
                        y: 30,
                        x2: 30,
                        y2: 40,
                        borderWidth: 0
                    },
                    legend: {
                        data: ['计划', '实产'],
                        x: 'right',
                        textStyle: {
                            color: "#e9ebee"
                        }
                    },
                    //calculable: false,
                    xAxis: [
                {
                    type: 'category',
                    splitLine: {
                        show: false
                    },
                    //data: xzdata,
                    data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#a4a7ab',
                            align: 'center'
                        },
                        axisTick: {
                            show: false
                        }
                    }
                }

            ],
                    yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: '#a4a7ab',
                            align: 'right'
                        }
                    },
                    axisTick: {
                        show: false
                    },
                    splitLine: {
                        show: false,
                        lineStyle: {
                            color: "#57617B"
                        }
                    }
                }
            ],
                    series: [
                {
                    name: '计划',
                    type: 'bar',
                    data: yzdata,
                    itemStyle: {        //上方显示数值
                        normal: {
                            label: {
                                show: true, //开启显示
                                position: 'top', //在上方显示
                                textStyle: { //数值样式
                                    color: 'White'
                                    //fontSize: 6
                                }
                            }
                        }
                    }
                },
                {
                    name: '实产',
                    type: 'bar',
                    data: zzdata,
                    itemStyle: {        //上方显示数值
                        normal: {
                            label: {
                                show: true, //开启显示
                                position: 'top', //在上方显示
                                textStyle: { //数值样式
                                    color: 'White'
                                    //fontSize: 6
                                }
                            }
                        }
                    }
                }
            ]
                };
                myChart2.setOption(option);
            }

            //var myChart = echarts.init(document.getElementById('container_huan')); //图表的ID
            function Echarts() {
                myChart3 = echarts.init(document.getElementById('container_huan')); //图表的ID
                var option = {
                    title: {
                        text: yyzdata,
                        subtext: '计划数量:' + xyzdata,
                        itemGap: 30,
                        x: 'center',
                        y: 70,
                        textAlign: "center",
                        textStyle: {
                            fontWeight: 'normal',
                            fontSize: 20,
                            color: '#FFB6C1'
                        },
                        subtextStyle: {
                            fontWeight: 'normal',
                            fontSize: 14,
                            color: '#FFFFFF',
                            lineHeight: 14
                        }
                    },
                    color: ["#0696ff", "#7ed321", "rgba(255,0,0,0)"],
                    series: [
                {
                    name: '',
                    type: 'pie',
                    radius: ['80%', '100%'],
                    //avoidLabelOverlap: false,
                    startAngle: 225,
                    center: ["50%", "50%"],
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                            labelLine: {
                                show: false
                            }
                        }
                    },
                    //data: zzzdata
                    data: [
                            { value: yyzdata },
                            { value: xyzdata-yyzdata },
                            { value: xyzdata/3 }
                        ]
                }
            ]
            };
            if (xyzdata == undefined) {
                option.title.subtext = "";
                }
                // 使用刚指定的配置项和数据显示图表。
                myChart3.setOption(option);

            }

            //var myChart = echarts.init(document.getElementById('main'));
            function EchartMains() {
                myChart4 = echarts.init(document.getElementById('main'));
                option = {

                    grid: { x: 56,
                        y: 10,
                      
                        y2: 10,
                         show: 'true', borderWidth: '0'
                    }, //echarts 去掉最外部边框
                    xAxis: [
        {
            type: 'value',
            axisLine: {
                show: false
            },
            axisTick: {
                show: false
            },
            axisLabel: {
                show: false
            },
            splitLine: {
                show: false
            }
        }
    ],
                    yAxis: [
        {
            type: 'category',
            axisLine: {
                show: false
            },
            axisTick: {
                show: false
            },
            axisLabel: {
                show: true,
                fontSize: 15,
                textStyle: { color: '#FFFFFF' }
            },
            splitLine: {
                show: false
            },
            data: ['线材', '心型环料斗', '压接管料斗', '铜鼻子料斗']
        },
                {
                    type: 'category',
                    axisLine: { show: false },
                    axisTick: { show: false },
                    axisLabel: { show: false },
                    splitArea: { show: false },
                    splitLine: { show: false },
                    data: ['线材', '心型环料斗', '压接管料斗', '铜鼻子料斗']
                }
    ],
                    series: [
        {

            barWidth: 20,
            type: 'bar',
        
            stack: '总量',
            itemStyle: { normal: { label: { show: true, position: 'right' }, barBorderRadius: 7} },
            data: xdxdata
        },
        {
            yAxisIndex: 1,
            barWidth: 20,
           barCategoryGap:'80%',
            type: 'bar',
            stack: '总量',
            itemStyle: { normal: { label: { show: true, position: 'insideRight' }, barBorderRadius: 7} },
            data: ydxdata
        }
    ]
                };
                myChart4.setOption(option);
            }
        </script>
</body>
</html>
